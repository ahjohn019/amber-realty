import{l as te,E as z,d as ve,u as De,ai as ce,a as oe,B as pe,r as u,n as C,x as w,D as a,s as _,a3 as ae,H as le,a5 as be,A as t,F as se,G as h,aj as xe,m as O,a7 as x,q as Ve,a6 as re}from"./ckeditor-90a70818.js";import{c as Se,Q as Ce}from"./vm-98611852.js";import{u as Pe,a as Ie,b as we}from"./use-checkbox-65d1f3bd.js";import{Q as V}from"./QInput-277c2892.js";import{Q as S}from"./QSelect-7b3862c7.js";import{Q as I}from"./QBtn-7f3b196f.js";import{C as ke,D as Fe,u as Te}from"./refList-95dc42e1.js";import{a as Ue,u as Qe}from"./index-2e4d8597.js";import{S as G,u as ue}from"./app-d2681744.js";import{Q as qe,a as Me}from"./QCardActions-1c960f1d.js";import{Q as v}from"./QCardSection-94fbad2c.js";import{Q as Ae}from"./QImg-128d8901.js";import{Q as ne}from"./QChip-ea03148d.js";import{Q as Be}from"./QSeparator-1cbc451b.js";import{Q as ie}from"./QCard-0bdafae9.js";import{Q as Ee}from"./QDialog-ebc4f304.js";import{C as Le}from"./ClosePopup-7b431b16.js";import"./option-sizes-5a060be6.js";import"./use-key-composition-619d00bf.js";import"./QMenu-81750110.js";import"./use-timeout-781162ef.js";import"./rtl-36dd996b.js";import"./use-prevent-scroll-4d3e0b4c.js";const je=Se({name:"QToggle",props:{...Pe,icon:String,iconColor:String},emits:Ie,setup(r){function o(i,e){const n=te(()=>(i.value===!0?r.checkedIcon:e.value===!0?r.indeterminateIcon:r.uncheckedIcon)||r.icon),m=te(()=>i.value===!0?r.iconColor:null);return()=>[z("div",{class:"q-toggle__track"}),z("div",{class:"q-toggle__thumb absolute flex flex-center no-wrap"},n.value!==void 0?[z(Ce,{name:n.value,color:m.value})]:void 0)]}return we("toggle",o)}}),de="/api/server-files/",Re=ve("server_image_admin",{state:()=>({post_image_admin:null,router:De(),route:ce()}),actions:{async updateFiles(r,o){const i={headers:{Authorization:`Bearer ${o}`,"Content-Type":"multipart/form-data"}};try{const e=await oe.post(de+"update",r,i);return G.fire({text:"Image Update Successfully",icon:"success"}).then(n=>{n.isConfirmed&&this.router.go(0)}),e.data}catch(e){return G.fire({title:e.response.data.data,text:e.response.data.message,icon:"error"}),e.response}},async deleteFiles(r,o){const i={headers:{Authorization:`Bearer ${o}`,"Content-Type":"multipart/form-data"}};try{const e=await oe.post(de+"delete",r,i);return G.fire({text:"Image Deleted Successfully",icon:"success"}).then(n=>{n.isConfirmed&&this.router.go(0)}),e.data}catch(e){throw console.error("Error:",e),e}},handleMultipleImageChange(r,o){const i=o.target.id,e=o.target.files[0],n=r.value.find(m=>m.id===i)||{id:i};return n.file=e,r.value.includes(n)||r.value.push(n),r}}});const Ne={props:["property"],setup(r){var U;const o=ue(),i=Re(),e=o.fetchSessionToken(),n=u(!1),m=[{label:"Banner Image",value:"banner-image"},{label:"Slider Image",value:"slider-image"}],l=((U=r.property)==null?void 0:U.file)||[],f=u([]),c=u([]),s=async()=>{c.value=l.map(d=>({module_path:d.module_path,file_id:d.id}))},k=d=>{const g=d.target.getAttribute("data-file-index");c.value[g].module_path=d.target.value},D=async d=>{const g=await i.deleteFiles(d,e);return n.value=!1,g},F=d=>i.handleMultipleImageChange(f,d),T=async()=>{const d={file:f.value,module_path:c.value},g=d.module_path.map(B=>{var P;const b=(P=d.file)==null?void 0:P.find(Q=>parseInt(Q.id)===B.file_id);return{...B,...b}}),A=await i.updateFiles(g,e);return n.value=!1,A};return s(),{existImageModal:n,files:l,updateFileData:T,onFileChange:F,handleDeleteFile:D,modulePathOptions:m,changeModulePath:k,fetchAllModulePath:s}}},ze=t("div",{class:"text-h5"},"Edit",-1),Oe={class:"col row"},Ge={class:"col"},He={class:"text-subtitle1 break-words"},Je={class:"text-subtitle2"},Ke=["onUpdate:modelValue","data-file-index"],We=t("option",{value:"banner-image"}," Banner Image ",-1),Xe=t("option",{value:"slider-image"}," Slider Image ",-1),Ye=[We,Xe],Ze=["id"];function $e(r,o,i,e,n,m){return C(),w(le,null,[a(I,{label:"Edit",color:"primary",onClick:o[0]||(o[0]=l=>e.existImageModal=!0),class:"edit-image-form__button"}),a(Ee,{modelValue:e.existImageModal,"onUpdate:modelValue":o[3]||(o[3]=l=>e.existImageModal=l)},{default:_(()=>[a(ie,null,{default:_(()=>[a(v,{class:"row items-center"},{default:_(()=>[ze,a(qe),ae(a(I,{icon:"close",flat:"",round:"",dense:""},null,512),[[Le]])]),_:1}),a(v,{class:"q-pt-none q-gutter-y-lg"},{default:_(()=>[(C(!0),w(le,null,be(e.files,(l,f)=>(C(),w("div",{class:"row items-center",key:f},[t("div",Oe,[t("div",Ge,[a(ie,{class:"my-card"},{default:_(()=>[a(Ae,{src:l.url,ratio:16/9,fit:"cover"},null,8,["src"]),a(v,null,{default:_(()=>[t("div",He,[a(ne,{color:"primary","text-color":"white"},{default:_(()=>[se(h(l.name),1)]),_:2},1024)]),t("div",Je,[a(ne,{color:"teal","text-color":"white",icon:"bookmark"},{default:_(()=>[se(h(Math.round(l.size/1e3)+"kb"),1)]),_:2},1024)])]),_:2},1024),a(v,{class:"row place-items-center justify-center"},{default:_(()=>[a(v,{class:"col-4 text-center"},{default:_(()=>[a(I,{size:"14px",round:"",color:"red",icon:"delete",onClick:c=>e.handleDeleteFile(l)},null,8,["onClick"])]),_:2},1024),a(Be,{vertical:""}),a(v,{class:"col-4"},{default:_(()=>[ae(t("select",{"onUpdate:modelValue":c=>l.module_path=c,"data-file-index":f,onChange:o[1]||(o[1]=(...c)=>e.changeModulePath&&e.changeModulePath(...c))},Ye,40,Ke),[[xe,l.module_path]])]),_:2},1024)]),_:2},1024),a(v,{class:"q-pt-none row justify-center"},{default:_(()=>[a(v,{class:"col-7"},{default:_(()=>[t("input",{type:"file",multiple:"",name:"file",id:l.id,class:"hidden-input",onChange:o[2]||(o[2]=(...c)=>e.onFileChange&&e.onFileChange(...c)),ref_for:!0,ref:"currentFile",accept:".pdf,.jpg,.jpeg,.png"},null,40,Ze)]),_:2},1024)]),_:2},1024)]),_:2},1024)])])]))),128))]),_:1}),a(Me,{align:"right"},{default:_(()=>[a(I,{label:"Update",class:"text-white bg-primary update-form__button",onClick:e.updateFileData},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const et=pe(Ne,[["render",$e]]);const tt={components:{CkeditorPlugin:ke,DropFile:Fe,ExistImageModal:et},async setup(){var W,X;const r=ce(),o=((W=r.query)==null?void 0:W.type)||null,i=((X=r.query)==null?void 0:X.id)||null,e=Ue(),n=Te(),m=Qe(),l=u(e.fetchPropertyData()),f=u(e.fetchPropertyDetailsData()),c=u(e.fetchPropertyError()),s=u([]),k=u(0),D=u(!1),F=u([]),T=u([]),U=u(null),d=u(""),g=u(""),A=u(!1);l.value.status="Active";const b=ue().fetchSessionToken(),P=e.fetchTenureData(),Q=e.fetchFurnishingData(),H=e.fetchListingTypeData(),me=e.fetchStatusData(),J=async()=>{const p=await n.fetchStateList(b);F.value=p},E=async()=>{const p=await n.fetchPropertyTypes(b);return T.value=p,p},_e=()=>(k.value=D.value?1:0,k.value),fe=p=>{l.value={...l.value,images:p.files,module_path:p.module_path}},ye=p=>{d.value=URL.createObjectURL(p.target.files[0]),g.value=p.target.files[0]},he=p=>{l.value.description=p},K=async()=>{const p=await E(),L=await m.findProperty(b,i),j=L.file.filter(N=>N.module_path==="banner-image");j.length>0&&(d.value=j[0].url);const{name:Y,description:Z,short_description:$,state:R,price:ee,file:q,type:M,details:y}=L;l.value={...l.value,name:Y,description:Z,short_description:$,state:R,price:ee,file:q,property_types:m.filteredPropertyDetails({type:p,details:M,category:"propertyType"})},y&&(D.value=!0,f.value={...f.value,tenure:m.filteredPropertyDetails({type:P,details:y.tenure}),square_feet:y.square_feet,listing_type:m.filteredPropertyDetails({type:H,details:y.listing_type}),furnishing:m.filteredPropertyDetails({type:Q,details:y.furnishing}),bedroom:y.bedroom,bathroom:y.bathroom})},ge=async()=>{var q,M;l.value={...l.value,property_details:D.value?1:0,status:{slug:((q=l.value.status)==null?void 0:q.slug)||"active",label:((M=l.value.status)==null?void 0:M.label)||"Active"},banner_url:g.value};const{tenure:p,bathroom:L,bedroom:j,square_feet:Y,listing_type:Z,furnishing:$,...R}=l.value;return l.value=R,l.value.property_details>0&&(l.value={...l.value,...Object.fromEntries(Object.entries(f.value).map(([y,N])=>[y,N??null]))}),await m.createProperty(b,l.value,c)};return o==="update"&&await K(),await J(),await E(),{findProperty:K,propertyData:l,propertyDetailsData:f,submitData:ge,updateParentFiles:fe,updateDescriptions:he,propertyDetailsToggle:D,handlePropertyDetails:_e,options:s,errors:c,tenure:P,furnishing:Q,listingType:H,status:me,state:F,property_types:T,stateList:J,propertyTypesList:E,mainImage:U,bannerUrl:d,updateMainImage:ye,routeType:o,existImageModal:A}}},ot={class:"row"},at={class:"col-12 row pb-4"},lt=t("div",{class:"col text-2xl"},"Property Form",-1),st={class:"col text-right"},rt=t("span",{class:"font-bold"},"Details",-1),nt={class:"col-12 row bg-white p-5 font-bold gap-y-4"},it={class:"col-12 post-information-name pb-2"},dt={class:"col-12"},ct=t("div",{class:"post-information-name"},"Name",-1),pt={class:"col-12"},ut={class:"col-12 text-red-700 pt-2"},mt={class:"col-12"},_t=t("div",{class:"post-information-name"},"Descriptions",-1),ft={class:"col-12"},yt={class:"col-12 text-red-700 pt-2"},ht={class:"col-12"},gt=t("div",{class:"post-information-name"},"Short Descriptions",-1),vt={class:"col-12"},Dt={class:"col-12 text-red-700 pt-2"},bt=t("div",{class:"post-information-name"},"Status",-1),xt={class:"col-12 col-md-6"},Vt=t("div",{class:"post-information-name"},"Types",-1),St={class:"col-12 text-red-700 pt-2"},Ct=t("div",{class:"post-information-name"},"State",-1),Pt={class:"col-12 text-red-700 pt-2"},It={class:"col-12 col-md-6"},wt=t("div",{class:"post-information-name"},"Price",-1),kt=t("div",{class:"post-information-name"},"Tenure",-1),Ft={class:"col-12 col-md-6"},Tt=t("div",{class:"post-information-name"},"Square Feet",-1),Ut=t("div",{class:"post-information-name"},"Listing Type",-1),Qt={class:"col-12 col-md-6"},qt=t("div",{class:"post-information-name"},"Furnished Type",-1),Mt=t("div",{class:"post-information-name"},"Bathroom",-1),At={class:"col-12 col-md-6"},Bt=t("div",{class:"post-information-name"},"Bedroom",-1),Et={class:"col-12"},Lt={class:"flex justify-between py-2"},jt=t("div",{class:"post-information__name"},"Images",-1),Rt={key:0},Nt={class:"col-12 text-red-700 pt-2"},zt={class:"col-12 text-right"};function Ot(r,o,i,e,n,m){const l=O("CkeditorPlugin"),f=O("ExistImageModal"),c=O("DropFile");return C(),w("div",ot,[t("div",at,[lt,t("div",st,[rt,a(je,{modelValue:e.propertyDetailsToggle,"onUpdate:modelValue":o[0]||(o[0]=s=>e.propertyDetailsToggle=s),color:"green",onClick:e.handlePropertyDetails},null,8,["modelValue","onClick"])])]),t("div",nt,[t("div",it,h(e.routeType=="update"?"Update":"Create")+" Property ",1),t("div",dt,[ct,t("div",pt,[a(V,{dense:"",outlined:"",label:"Name",modelValue:e.propertyData.name,"onUpdate:modelValue":o[1]||(o[1]=s=>e.propertyData.name=s),ref:"nameRef"},null,8,["modelValue"])]),t("div",ut,h(e.errors.name),1)]),t("div",mt,[_t,t("div",ft,[a(l,{description:e.propertyData.description,onUpdateDescriptionsData:e.updateDescriptions},null,8,["description","onUpdateDescriptionsData"])]),t("div",yt,h(e.errors.description),1)]),t("div",ht,[gt,t("div",vt,[a(V,{modelValue:e.propertyData.short_description,"onUpdate:modelValue":o[2]||(o[2]=s=>e.propertyData.short_description=s),filled:"",outlined:"",placeholder:"Short Descriptions",type:"textarea"},null,8,["modelValue"])]),t("div",Dt,h(e.errors.short_description),1)]),t("div",{class:x(["col-12 col-md-6",r.$q.screen.lt.md?"pr-0":"pr-6"])},[bt,a(S,{dense:"",modelValue:e.propertyData.status,"onUpdate:modelValue":o[3]||(o[3]=s=>e.propertyData.status=s),options:e.status,"option-value":"slug","option-label":"label",label:"Status"},null,8,["modelValue","options"])],2),t("div",xt,[Vt,a(S,{dense:"",modelValue:e.propertyData.property_types,"onUpdate:modelValue":o[4]||(o[4]=s=>e.propertyData.property_types=s),options:e.property_types,"option-value":"id","option-label":"label",label:"Please Select"},null,8,["modelValue","options"]),t("div",St,h(e.errors.type_id),1)]),t("div",{class:x(["col-12 col-md-6",r.$q.screen.lt.md?"pr-0":"pr-6"])},[Ct,a(S,{dense:"",modelValue:e.propertyData.state,"onUpdate:modelValue":o[5]||(o[5]=s=>e.propertyData.state=s),options:e.state,"option-value":"id","option-label":"label",label:"Please Select"},null,8,["modelValue","options"]),t("div",Pt,h(e.errors.state_id),1)],2),t("div",It,[wt,a(V,{dense:"",outlined:"",label:"Price",modelValue:e.propertyData.price,"onUpdate:modelValue":o[6]||(o[6]=s=>e.propertyData.price=s),type:"number"},null,8,["modelValue"])]),t("div",{class:x(["col-12 row gap-y-4",e.propertyDetailsToggle?"":"hidden"])},[t("div",{class:x(["col-12 col-md-6",r.$q.screen.lt.md?"pr-0":"pr-6"])},[kt,a(S,{dense:"",modelValue:e.propertyDetailsData.tenure,"onUpdate:modelValue":o[7]||(o[7]=s=>e.propertyDetailsData.tenure=s),options:e.tenure,"option-value":"slug","option-label":"label",label:"Please Select"},null,8,["modelValue","options"])],2),t("div",Ft,[Tt,a(V,{dense:"",outlined:"",label:"Square Feet",modelValue:e.propertyDetailsData.square_feet,"onUpdate:modelValue":o[8]||(o[8]=s=>e.propertyDetailsData.square_feet=s),type:"number"},null,8,["modelValue"])]),t("div",{class:x(["col-12 col-md-6",r.$q.screen.lt.md?"pr-0":"pr-6"])},[Ut,a(S,{dense:"",modelValue:e.propertyDetailsData.listing_type,"onUpdate:modelValue":o[9]||(o[9]=s=>e.propertyDetailsData.listing_type=s),options:e.listingType,"option-value":"slug","option-label":"label",label:"Please Select"},null,8,["modelValue","options"])],2),t("div",Qt,[qt,a(S,{dense:"",modelValue:e.propertyDetailsData.furnishing,"onUpdate:modelValue":o[10]||(o[10]=s=>e.propertyDetailsData.furnishing=s),options:e.furnishing,"option-value":"slug","option-label":"label",label:"Please Select"},null,8,["modelValue","options"])]),t("div",{class:x(["col-12 col-md-6",r.$q.screen.lt.md?"pr-0":"pr-6"])},[Mt,a(V,{dense:"",outlined:"",label:"Bathroom",modelValue:e.propertyDetailsData.bathroom,"onUpdate:modelValue":o[11]||(o[11]=s=>e.propertyDetailsData.bathroom=s),type:"number"},null,8,["modelValue"])],2),t("div",At,[Bt,a(V,{dense:"",outlined:"",label:"Bedroom",modelValue:e.propertyDetailsData.bedroom,"onUpdate:modelValue":o[12]||(o[12]=s=>e.propertyDetailsData.bedroom=s),type:"number"},null,8,["modelValue"])])],2),t("div",Et,[t("div",Lt,[jt,e.routeType==="update"?(C(),w("div",Rt,[e.propertyData.file.length>0?(C(),Ve(f,{key:0,property:e.propertyData},null,8,["property"])):re("",!0)])):re("",!0)]),a(c,{onUpdateFiles:e.updateParentFiles,propertyData:e.propertyData},null,8,["onUpdateFiles","propertyData"]),t("div",Nt,h(e.errors.module_path),1)]),t("div",zt,[a(I,{label:e.routeType=="update"?"Update":"Submit",class:"text-white bg-primary update-form__button",onClick:e.submitData},null,8,["label","onClick"])])])])}const fo=pe(tt,[["render",Ot]]);export{fo as default};
