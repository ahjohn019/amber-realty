import{Q as V}from"./QBtn-265fd93a.js";import{Q as D}from"./vm-9a171682.js";import{Q as G}from"./QInput-79b59fd5.js";import{Q as J,a as M,c as X}from"./QTable-302298d9.js";import{Q as L}from"./QCheckbox-6da6ba5f.js";import{L as ee,M as te,z as Q,r as u,m,u as y,A as t,q as l,F as U,T as oe,n as q,D as S,E,y as _,W as le,Y as ne,o as ae,l as K,U as I,Z as re}from"./ckeditor-f906adf3.js";import{u as B,a as se}from"./index-21fe9e24.js";import{u as C}from"./auth-8ea048e2.js";import{Q as ie}from"./QCardSection-8deeede3.js";import{Q as N,b as de,a as ce}from"./QSeparator-4cec5070.js";import{Q as k,a as g,b as v}from"./QMenu-04e4f18c.js";import{Q as ue}from"./QCard-f936047c.js";import{d as he}from"./dayjs.min-a9745ad6.js";import"./QSelect-fcc3eed1.js";import"./QChip-6657b2d8.js";import"./QDialog-2de290bf.js";import"./use-prevent-scroll-23dfb168.js";import"./use-tick-035461a6.js";import"./rtl-36dd996b.js";import"./format-7985d814.js";import"./use-checkbox-e1f4caae.js";import"./option-sizes-d9e7955c.js";const me=ee("server_table_admin",{state:()=>({post_table_admin:null,router:te()}),actions:{fetchPaginationData(r,e){const{page:s,rowsPerPage:o,sortBy:i,descending:d}=r;return e={...e,attribute:i,sortable:d?"desc":"asc",page:s,paginate:o},e.paginate<=0&&(e.paginate=r.rowsNumber),e},fetchServerPagination(r,e){return{rowsNumber:r.meta.total,page:e.page,rowsPerPage:e.rowsPerPage,sortBy:e.sortBy,descending:e.descending}},fetchServerPayload(r,e){return{...r,rowsPerPage:e.meta.per_page}},async fetchTableListData(r,e,s,o,i){const a=C().fetchSessionToken(),{page:h}=r??{page:1,rowsPerPage:15,sortBy:null,descending:null};return e.value=!0,await s[o](a,h,i)}}});const ge={props:["props","propertyHighlights"],setup(r,{emit:e}){var w;const s=B(),i=C().fetchSessionToken(),d=((w=r.props.row)==null?void 0:w.id)||null,a=u([]),h=u([]),n=u([]);return n.value=r.propertyHighlights,{handleView:()=>{s.handleViewProperty(d,r.props)},handleEdit:()=>{s.handleEditProperty(d)},handleDelete:async()=>{await s.handleDeleteProperty(d,i)},handleHighlightMobile:p=>{p.highlight=p.checked;const x=s.handleHighlights(p,n.value);h.value=x,e("mobileHighlightsData",h.value)},selected:a,propertyHighlightsMobile:n,propertySubmitHighlights:h,submitHighlight:async()=>{await s.submitHighlight(h.value,i)},getSelectedString(){return console.log(a.value),a.value.length===0?"":`${a.value.length} record${a.value.length>1?"s":""}`}}}},pe=["innerHTML"],fe={key:1},be={class:"q-gutter-md"};function ye(r,e,s,o,i,d){return m(),y("div",{class:"q-pa-xs col-xs-12 col-sm-6 col-md-4 col-lg-3 grid-style-transition",style:ne(s.props.selected?"transform: scale(0.95);":"")},[t(ue,{bordered:"",flat:"",class:le(s.props.selected?r.$q.dark.isActive?"bg-grey-9":"bg-grey-2":"")},{default:l(()=>[t(N,null,{default:l(()=>[t(ie,null,{default:l(()=>[t(L,{dense:"",modelValue:s.props.selected,"onUpdate:modelValue":e[0]||(e[0]=a=>s.props.selected=a),label:s.props.row.name},null,8,["modelValue","label"])]),_:1}),t(de),(m(!0),y(U,null,oe(s.props.cols.filter(a=>!["action","highlight"].includes(a.name)),a=>(m(),q(k,{key:a.name},{default:l(()=>[t(g,null,{default:l(()=>[t(v,null,{default:l(()=>[S(E(a.label),1)]),_:2},1024),t(v,{caption:""},{default:l(()=>[a.name=="short_description"?(m(),y("div",{key:0,innerHTML:a.value,class:"break-all"},null,8,pe)):(m(),y("div",fe,E(a.value),1))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),t(k,null,{default:l(()=>[t(g,null,{default:l(()=>[t(v,null,{default:l(()=>[S("Highlights")]),_:1}),t(L,{size:"sm",modelValue:s.props.row.checked,"onUpdate:modelValue":e[1]||(e[1]=a=>s.props.row.checked=a),val:"sm",onClick:e[2]||(e[2]=a=>o.handleHighlightMobile(s.props.row))},null,8,["modelValue"])]),_:1})]),_:1}),t(k,null,{default:l(()=>[t(g,null,{default:l(()=>[t(v,null,{default:l(()=>[S("Action")]),_:1}),_("div",be,[t(V,{color:"primary",icon:"visibility",label:"View",size:"sm",onClick:e[3]||(e[3]=a=>o.handleView())}),t(V,{color:"secondary",icon:"edit",label:"Edit",size:"sm",onClick:e[4]||(e[4]=a=>o.handleEdit())}),t(V,{color:"red",icon:"delete",label:"Delete",size:"sm",onClick:e[5]||(e[5]=a=>o.handleDelete())})])]),_:1})]),_:1})]),_:1})]),_:1},8,["class"])],4)}const ve=Q(ge,[["render",ye]]),_e={props:{data:Object},setup(r){var n;const e=B(),o=C().fetchSessionToken(),i=((n=r.data.row)==null?void 0:n.id)||null;return{handleEdit:()=>{e.handleEditProperty(i,r)},handleDelete:async()=>{await e.handleDeleteProperty(i,o)},handleView:()=>{e.handleViewProperty(i,r)}}}},we=_("div",{class:"row items-center no-wrap font-bold"},"Edit",-1);function Se(r,e,s,o,i,d){return m(),y("div",null,[t(ce,{color:"transparent",class:"text-black font-bold","dropdown-icon":"expand_more"},{label:l(()=>[we]),default:l(()=>[t(N,{class:"q-table-edit-dropdown-list"},{default:l(()=>[t(k,{clickable:"",onClick:e[0]||(e[0]=a=>o.handleView())},{default:l(()=>[t(g,null,{default:l(()=>[t(D,{name:"visibility"})]),_:1}),t(g,null,{default:l(()=>[t(v,null,{default:l(()=>[S("View")]),_:1})]),_:1})]),_:1}),t(k,{clickable:"",onClick:e[1]||(e[1]=a=>o.handleEdit())},{default:l(()=>[t(g,null,{default:l(()=>[t(D,{name:"edit"})]),_:1}),t(g,null,{default:l(()=>[t(v,null,{default:l(()=>[S("Edit")]),_:1})]),_:1})]),_:1}),t(k,{clickable:"",onClick:e[2]||(e[2]=a=>o.handleDelete())},{default:l(()=>[t(g,null,{default:l(()=>[t(D,{name:"delete"})]),_:1}),t(g,null,{default:l(()=>[t(v,null,{default:l(()=>[S("Delete")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}const ke=Q(_e,[["render",Se]]),Pe={components:{TableStatus:ke,TableMobileResponsive:ve},setup(){const r=u(),e=u([]),s=u([]),o=u(!1),i=u({sortBy:"name",descending:!1,page:1,rowsPerPage:15,rowsNumber:null}),d=u([]),a=u({}),h=u(""),n=B(),P=se(),H=me(),R=C().fetchSessionToken(),T=u([]),w=u([]),p=u(!1),x=c=>{p.value=!0,T.value=c},j=c=>{p.value=!0;const f=n.handleHighlights(c,w.value);T.value=f},F=async()=>{await n.submitHighlight(T.value,R)},$=c=>H.fetchPaginationData(c,a.value),O=c=>{a.value={...a.value,keyword:c,searchable:["name","short_description","price","listing_type"],page:1,attribute:"name",sortable:"asc",paginate:15},z(null,a.value)},z=async(c,f)=>{const b=await H.fetchTableListData(c,o,n,"fetchPropertyList",f);w.value=b.data;const Z=b.data.map(A=>({...A,created_by:A.user.name,created_at:he(A.created_at).format("YYYY-MM-DD HH:mm:ss")}));return e.value=Z,c!=null&&(i.value=H.fetchServerPagination(b,c)),f=H.fetchServerPayload(f,b),o.value=!1,b},W=async c=>{const f=$(c.pagination),b=P.fetchPropertyColumns();return s.value=b,z(c.pagination,f)};return ae(()=>{r.value.requestServerInteraction()}),{propertyRef:r,loading:o,pagination:i,columns:s,rows:e,onRequest:W,selected:d,fetchPagination:$,handlePostKeywords:O,searchKeyword:h,handleHighlight:j,submitHighlight:F,isHighlighted:p,propertySubmitHighlights:T,propertyHighlights:w,mobileHighlightSelection:x,getSelectedString(){return d.value.length===0?"":`${d.value.length} record${d.value.length>1?"s":""} selected of ${e.value.length}`}}}},He={class:"q-py-md"},Te=["for"],Ve=["innerHTML"];function De(r,e,s,o,i,d){const a=K("TableStatus"),h=K("TableMobileResponsive");return m(),y("div",He,[t(X,{flat:"",ref:"propertyRef",bordered:"",grid:r.$q.screen.lt.md,rows:o.rows,columns:o.columns,pagination:o.pagination,"onUpdate:pagination":e[5]||(e[5]=n=>o.pagination=n),selected:o.selected,"onUpdate:selected":e[6]||(e[6]=n=>o.selected=n),loading:o.loading,"binary-state-sort":"",onRequest:o.onRequest,"selected-rows-label":o.getSelectedString,selection:"multiple","row-key":"name",class:"property-table","wrap-cells":""},{"top-right":l(()=>[o.isHighlighted?(m(),q(V,{key:0,color:"primary",icon:"star",class:"mr-4",onClick:e[0]||(e[0]=n=>o.submitHighlight(r.propertyData))})):I("",!0),t(G,{borderless:"",dense:"",debounce:"300",modelValue:o.searchKeyword,"onUpdate:modelValue":e[3]||(e[3]=n=>o.searchKeyword=n),placeholder:"Search",class:"border px-4 rounded-lg",onKeyup:e[4]||(e[4]=re(n=>o.handlePostKeywords(o.searchKeyword),["enter"]))},{append:l(()=>[o.searchKeyword!==""?(m(),q(D,{key:0,name:"close",onClick:e[1]||(e[1]=n=>o.searchKeyword=""),class:"cursor-pointer"})):I("",!0),t(D,{name:"search",onClick:e[2]||(e[2]=n=>o.handlePostKeywords(o.searchKeyword)),class:"cursor-pointer"})]),_:1},8,["modelValue"])]),"header-cell":l(n=>[t(J,{props:n,style:{"text-wrap":"nowrap"}},{default:l(()=>[_("label",{for:n.col.label,class:"font-bold text-sm"},E(n.col.label),9,Te)]),_:2},1032,["props"])]),"body-cell-short_description":l(n=>[t(M,{props:n},{default:l(()=>[_("div",{class:"break-all",innerHTML:n.value},null,8,Ve)]),_:2},1032,["props"])]),"body-cell-highlight":l(n=>[t(M,{props:n},{default:l(()=>[t(L,{size:"sm",modelValue:n.row.checked,"onUpdate:modelValue":P=>n.row.checked=P,val:"sm",onClick:P=>o.handleHighlight(n.row)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:2},1032,["props"])]),"body-cell-action":l(n=>[t(M,{props:n},{default:l(()=>[t(a,{data:n},null,8,["data"])]),_:2},1032,["props"])]),item:l(n=>[t(h,{props:n,propertyHighlights:o.propertyHighlights,onMobileHighlightsData:o.mobileHighlightSelection},null,8,["props","propertyHighlights","onMobileHighlightsData"])]),_:1},8,["grid","rows","columns","pagination","selected","loading","onRequest","selected-rows-label"])])}const Qe=Q(Pe,[["render",De]]),Ce={components:{TableList:Qe}},xe={class:"row q-gutter-y-sm justify-between"},Ae=_("div",{class:"col col-auto text-2xl"},"Property List",-1),Me={class:"col col-auto text-right"};function Le(r,e,s,o,i,d){const a=K("TableList");return m(),y(U,null,[_("div",xe,[Ae,_("div",Me,[t(V,{"icon-right":"add",label:"Add Property",class:"!font-bold text-white",color:"primary",to:{name:"property.form",query:{type:"create"}}},null,8,["to"])])]),t(a)],64)}const lt=Q(Ce,[["render",Le]]);export{lt as default};
