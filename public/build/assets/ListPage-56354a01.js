import{Q as k}from"./QBtn-c4aed158.js";import{Q as D}from"./vm-287ad375.js";import{Q as J}from"./QInput-2db4e532.js";import{Q as Z,a as q,c as ee}from"./QTable-19b5d847.js";import{Q as E}from"./QCheckbox-8a08c94f.js";import{f as te,u as le,D as C,r as u,q as m,y as v,E as t,t as o,I as U,P as oe,s as Q,G as H,H as B,B as p,T as K,W as ne,o as ae,n as R,R as L,X as se}from"./ckeditor-75d48d99.js";import{u as $,a as re}from"./index-5f508ce5.js";import{u as A}from"./auth-6ecaa408.js";import{Q as ie}from"./QCardSection-23243dbf.js";import{Q as Y,b as de,a as ce}from"./QSeparator-a24a473f.js";import{Q as P,a as g,b as _}from"./QMenu-babb46b9.js";import{Q as ue}from"./QCard-48064bf2.js";import{d as he}from"./dayjs.min-d0ab8850.js";import"./QSelect-02aea605.js";import"./QChip-76f71953.js";import"./QDialog-aaa61d1c.js";import"./use-tick-309b3908.js";import"./rtl-36dd996b.js";import"./use-checkbox-5e51a338.js";import"./option-sizes-b7a8b75e.js";const me=te("server_table_admin",{state:()=>({post_table_admin:null,router:le()}),actions:{fetchPaginationData(s,e){const{page:r,rowsPerPage:l,sortBy:i,descending:d}=s;return e={...e,attribute:i,sortable:d?"desc":"asc",page:r,paginate:l},e.paginate<=0&&(e.paginate=s.rowsNumber),e},fetchServerPagination(s,e){return{rowsNumber:s.meta.total,page:e.page,rowsPerPage:e.rowsPerPage,sortBy:e.sortBy,descending:e.descending}},fetchServerPayload(s,e){return{...s,rowsPerPage:e.meta.per_page}},async fetchTableListData(s,e,r,l,i){const a=A().fetchSessionToken(),{page:h}=s??{page:1,rowsPerPage:15,sortBy:null,descending:null};return e.value=!0,await r[l](a,h,i)}}});const ge={props:["props","propertyHighlights"],setup(s,{emit:e}){var S;const r=$(),i=A().fetchSessionToken(),d=((S=s.props.row)==null?void 0:S.id)||null,a=u([]),h=u([]),n=u([]);return n.value=s.propertyHighlights,{handleView:()=>{r.handleViewProperty(d,s.props)},handleEdit:()=>{r.handleEditProperty(d)},handleDelete:async()=>{await r.handleDeleteProperty(d,i)},handleHighlightMobile:f=>{f.highlight=f.checked;const x=r.handleHighlights(f,n.value);h.value=x,e("mobileHighlightsData",h.value)},selected:a,propertyHighlightsMobile:n,propertySubmitHighlights:h,submitHighlight:async()=>{await r.submitHighlight(h.value,i)},getSelectedString(){return console.log(a.value),a.value.length===0?"":`${a.value.length} record${a.value.length>1?"s":""}`}}}},pe=["innerHTML"],fe={key:1},be={class:"q-gutter-md"};function ye(s,e,r,l,i,d){return m(),v("div",{class:"q-pa-xs col-xs-12 col-sm-6 col-md-4 col-lg-3 grid-style-transition",style:ne(r.props.selected?"transform: scale(0.95);":"")},[t(ue,{bordered:"",flat:"",class:K(r.props.selected?s.$q.dark.isActive?"bg-grey-9":"bg-grey-2":"")},{default:o(()=>[t(Y,null,{default:o(()=>[t(ie,null,{default:o(()=>[t(E,{dense:"",modelValue:r.props.selected,"onUpdate:modelValue":e[0]||(e[0]=a=>r.props.selected=a),label:r.props.row.name},null,8,["modelValue","label"])]),_:1}),t(de),(m(!0),v(U,null,oe(r.props.cols.filter(a=>!["action","highlight"].includes(a.name)),a=>(m(),Q(P,{key:a.name},{default:o(()=>[t(g,null,{default:o(()=>[t(_,null,{default:o(()=>[H(B(a.label),1)]),_:2},1024),t(_,{caption:""},{default:o(()=>[a.name=="short_description"?(m(),v("div",{key:0,innerHTML:a.value,class:"break-all"},null,8,pe)):(m(),v("div",fe,B(a.value),1))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),t(P,null,{default:o(()=>[t(g,null,{default:o(()=>[t(_,null,{default:o(()=>[H("Highlights")]),_:1}),t(E,{size:"sm",modelValue:r.props.row.checked,"onUpdate:modelValue":e[1]||(e[1]=a=>r.props.row.checked=a),val:"sm",onClick:e[2]||(e[2]=a=>l.handleHighlightMobile(r.props.row))},null,8,["modelValue"])]),_:1})]),_:1}),t(P,null,{default:o(()=>[t(g,null,{default:o(()=>[t(_,null,{default:o(()=>[H("Action")]),_:1}),p("div",be,[t(k,{color:"primary",icon:"visibility",label:"View",size:"sm",onClick:e[3]||(e[3]=a=>l.handleView())}),t(k,{color:"secondary",icon:"edit",label:"Edit",size:"sm",onClick:e[4]||(e[4]=a=>l.handleEdit())}),t(k,{color:"red",icon:"delete",label:"Delete",size:"sm",onClick:e[5]||(e[5]=a=>l.handleDelete())})])]),_:1})]),_:1})]),_:1})]),_:1},8,["class"])],4)}const ve=C(ge,[["render",ye]]),_e={props:{data:Object},setup(s){var n;const e=$(),l=A().fetchSessionToken(),i=((n=s.data.row)==null?void 0:n.id)||null;return{handleEdit:()=>{e.handleEditProperty(i,s)},handleDelete:async()=>{await e.handleDeleteProperty(i,l)},handleView:()=>{e.handleViewProperty(i,s)}}}},we=p("div",{class:"row items-center no-wrap font-bold"},"Edit",-1);function Se(s,e,r,l,i,d){return m(),v("div",null,[t(ce,{color:"transparent",class:"text-black font-bold","dropdown-icon":"expand_more"},{label:o(()=>[we]),default:o(()=>[t(Y,{class:"q-table-edit-dropdown-list"},{default:o(()=>[t(P,{clickable:"",onClick:e[0]||(e[0]=a=>l.handleView())},{default:o(()=>[t(g,null,{default:o(()=>[t(D,{name:"visibility"})]),_:1}),t(g,null,{default:o(()=>[t(_,null,{default:o(()=>[H("View")]),_:1})]),_:1})]),_:1}),t(P,{clickable:"",onClick:e[1]||(e[1]=a=>l.handleEdit())},{default:o(()=>[t(g,null,{default:o(()=>[t(D,{name:"edit"})]),_:1}),t(g,null,{default:o(()=>[t(_,null,{default:o(()=>[H("Edit")]),_:1})]),_:1})]),_:1}),t(P,{clickable:"",onClick:e[2]||(e[2]=a=>l.handleDelete())},{default:o(()=>[t(g,null,{default:o(()=>[t(D,{name:"delete"})]),_:1}),t(g,null,{default:o(()=>[t(_,null,{default:o(()=>[H("Delete")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}const ke=C(_e,[["render",Se]]),He={components:{TableStatus:ke,TableMobileResponsive:ve},setup(){const s=u(),e=u([]),r=u([]),l=u(!1),i=u({sortBy:"name",descending:!1,page:1,rowsPerPage:15,rowsNumber:null}),d=u([]),a=u({}),h=u(""),n=$(),w=re(),T=me(),I=A().fetchSessionToken(),V=u([]),S=u([]),f=u(!1),x=c=>{f.value=!0,V.value=c},F=c=>{f.value=!0;const b=n.handleHighlights(c,S.value);V.value=b},G=async()=>{await n.submitHighlight(V.value,I)},z=c=>T.fetchPaginationData(c,a.value),O=c=>{a.value={...a.value,keyword:c,searchable:["name","short_description","price","listing_type"],page:1,attribute:"name",sortable:"asc",paginate:15},N(null,a.value)},N=async(c,b)=>{const y=await T.fetchTableListData(c,l,n,"fetchPropertyList",b);S.value=y.data;const X=y.data.map(M=>({...M,created_by:M.user.name,created_at:he(M.created_at).format("YYYY-MM-DD HH:mm:ss")}));return e.value=X,c!=null&&(i.value=T.fetchServerPagination(y,c)),b=T.fetchServerPayload(b,y),l.value=!1,y},W=async c=>{const b=z(c.pagination),y=w.fetchPropertyColumns();return r.value=y,N(c.pagination,b)};return ae(()=>{s.value.requestServerInteraction()}),{propertyRef:s,loading:l,pagination:i,columns:r,rows:e,onRequest:W,selected:d,fetchPagination:z,handlePostKeywords:O,searchKeyword:h,handleHighlight:F,submitHighlight:G,isHighlighted:f,propertySubmitHighlights:V,propertyHighlights:S,mobileHighlightSelection:x,getSelectedString(){return d.value.length===0?"":`${d.value.length} record${d.value.length>1?"s":""} selected of ${e.value.length}`}}}},Pe={class:"q-py-md"},Te=["for"],Ve=["innerHTML"],De={class:"fixed bottom-20 right-0"};function Qe(s,e,r,l,i,d){const a=R("TableStatus"),h=R("TableMobileResponsive");return m(),v("div",Pe,[t(ee,{flat:"",ref:"propertyRef",bordered:"",grid:s.$q.screen.lt.md,rows:l.rows,columns:l.columns,pagination:l.pagination,"onUpdate:pagination":e[6]||(e[6]=n=>l.pagination=n),selected:l.selected,"onUpdate:selected":e[7]||(e[7]=n=>l.selected=n),loading:l.loading,"binary-state-sort":"",onRequest:l.onRequest,"selected-rows-label":l.getSelectedString,selection:"multiple","row-key":"name",class:"property-table","wrap-cells":""},{"top-right":o(()=>[l.isHighlighted?(m(),Q(k,{key:0,color:"primary",icon:"star",class:K(["mr-4",s.$q.screen.lt.sm?"hidden":""]),onClick:e[0]||(e[0]=n=>l.submitHighlight(s.propertyData))},null,8,["class"])):L("",!0),t(J,{borderless:"",dense:"",debounce:"300",modelValue:l.searchKeyword,"onUpdate:modelValue":e[3]||(e[3]=n=>l.searchKeyword=n),placeholder:"Search",class:"border px-4 rounded-lg",onKeyup:e[4]||(e[4]=se(n=>l.handlePostKeywords(l.searchKeyword),["enter"]))},{append:o(()=>[l.searchKeyword!==""?(m(),Q(D,{key:0,name:"close",onClick:e[1]||(e[1]=n=>l.searchKeyword=""),class:"cursor-pointer"})):L("",!0),t(D,{name:"search",onClick:e[2]||(e[2]=n=>l.handlePostKeywords(l.searchKeyword)),class:"cursor-pointer"})]),_:1},8,["modelValue"])]),"header-cell":o(n=>[t(Z,{props:n,style:{"text-wrap":"nowrap"}},{default:o(()=>[p("label",{for:n.col.label,class:"font-bold text-sm"},B(n.col.label),9,Te)]),_:2},1032,["props"])]),"body-cell-short_description":o(n=>[t(q,{props:n},{default:o(()=>[p("div",{class:"break-all",innerHTML:n.value},null,8,Ve)]),_:2},1032,["props"])]),"body-cell-highlight":o(n=>[t(q,{props:n},{default:o(()=>[t(E,{size:"sm",modelValue:n.row.checked,"onUpdate:modelValue":w=>n.row.checked=w,val:"sm",onClick:w=>l.handleHighlight(n.row)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:2},1032,["props"])]),"body-cell-action":o(n=>[t(q,{props:n},{default:o(()=>[t(a,{data:n},null,8,["data"])]),_:2},1032,["props"])]),item:o(n=>[t(h,{props:n,propertyHighlights:l.propertyHighlights,onMobileHighlightsData:l.mobileHighlightSelection},null,8,["props","propertyHighlights","onMobileHighlightsData"]),p("div",De,[l.isHighlighted?(m(),Q(k,{key:0,round:"",color:"primary",icon:"star",class:K(["mr-4",s.$q.screen.lt.sm?"":"hidden"]),onClick:e[5]||(e[5]=w=>l.submitHighlight(s.propertyData))},null,8,["class"])):L("",!0)])]),_:1},8,["grid","rows","columns","pagination","selected","loading","onRequest","selected-rows-label"])])}const Ce=C(He,[["render",Qe]]),Ae={components:{TableList:Ce}},xe={class:"row q-gutter-y-sm justify-between"},Me=p("div",{class:"col col-auto text-2xl"},"Property List",-1),qe={class:"col col-auto text-right"};function Le(s,e,r,l,i,d){const a=R("TableList");return m(),v(U,null,[p("div",xe,[Me,p("div",qe,[t(k,{"icon-right":"add",label:"Add Property",class:"!font-bold text-white",color:"primary",to:{name:"property.form",query:{type:"create"}}},null,8,["to"])])]),t(a)],64)}const lt=C(Ae,[["render",Le]]);export{lt as default};
