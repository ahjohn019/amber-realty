import{Q as w}from"./QBtn-265fd93a.js";import{Q as S}from"./vm-9a171682.js";import{Q as O}from"./QInput-79b59fd5.js";import{Q as W,a as C,c as Z}from"./QTable-302298d9.js";import{Q as B}from"./QCheckbox-6da6ba5f.js";import{L as G,M as J,z as Q,r as u,m,u as b,A as t,q as n,F as R,T as X,n as x,D as k,E as L,y as _,W as ee,Y as te,o as oe,l as q,U as K,Z as ne}from"./ckeditor-f906adf3.js";import{u as $,a as le}from"./index-7a6be18b.js";import{u as V}from"./auth-8ea048e2.js";import{Q as ae}from"./QCardSection-8deeede3.js";import{Q as I,b as re,a as se}from"./QSeparator-4cec5070.js";import{Q as P,a as f,b as v}from"./QMenu-04e4f18c.js";import{Q as ie}from"./QCard-f936047c.js";import{d as de}from"./dayjs.min-a9745ad6.js";import"./QSelect-fcc3eed1.js";import"./QChip-6657b2d8.js";import"./QDialog-2de290bf.js";import"./use-prevent-scroll-23dfb168.js";import"./use-tick-035461a6.js";import"./rtl-36dd996b.js";import"./format-7985d814.js";import"./use-checkbox-e1f4caae.js";import"./option-sizes-d9e7955c.js";const ce=G("server_table_admin",{state:()=>({post_table_admin:null,router:J()}),actions:{fetchPaginationData(r,e){const{page:i,rowsPerPage:o,sortBy:d,descending:c}=r;return e={...e,attribute:d,sortable:c?"desc":"asc",page:i,paginate:o},e.paginate<=0&&(e.paginate=r.rowsNumber),e},fetchServerPagination(r,e){return{rowsNumber:r.meta.total,page:e.page,rowsPerPage:e.rowsPerPage,sortBy:e.sortBy,descending:e.descending}},fetchServerPayload(r,e){return{...r,rowsPerPage:e.meta.per_page}},async fetchTableListData(r,e,i,o,d){const a=V().fetchSessionToken(),{page:g}=r??{page:1,rowsPerPage:15,sortBy:null,descending:null};return e.value=!0,await i[o](a,g,d)}}});const ue={props:["props"],setup(r){var y;const e=$(),o=V().fetchSessionToken(),d=((y=r.props.row)==null?void 0:y.id)||null,c=u([]);return{handleView:()=>{e.handleViewProperty(d,r.props)},handleEdit:()=>{e.handleEditProperty(d)},handleDelete:async()=>{await e.handleDeleteProperty(d,o)},selected:c,getSelectedString(){return console.log(c.value),c.value.length===0?"":`${c.value.length} record${c.value.length>1?"s":""}`}}}},me=["innerHTML"],pe={key:1},he={class:"q-gutter-md"};function fe(r,e,i,o,d,c){return m(),b("div",{class:"q-pa-xs col-xs-12 col-sm-6 col-md-4 col-lg-3 grid-style-transition",style:te(i.props.selected?"transform: scale(0.95);":"")},[t(ie,{bordered:"",flat:"",class:ee(i.props.selected?r.$q.dark.isActive?"bg-grey-9":"bg-grey-2":"")},{default:n(()=>[t(I,null,{default:n(()=>[t(ae,null,{default:n(()=>[t(B,{dense:"",modelValue:i.props.selected,"onUpdate:modelValue":e[0]||(e[0]=a=>i.props.selected=a),label:i.props.row.name},null,8,["modelValue","label"])]),_:1}),t(re),(m(!0),b(R,null,X(i.props.cols.filter(a=>a.name!=="action"),a=>(m(),x(P,{key:a.name},{default:n(()=>[t(f,null,{default:n(()=>[t(v,null,{default:n(()=>[k(L(a.label),1)]),_:2},1024),t(v,{caption:""},{default:n(()=>[a.name=="short_description"?(m(),b("div",{key:0,innerHTML:a.value,class:"break-all"},null,8,me)):(m(),b("div",pe,L(a.value),1))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),t(P,null,{default:n(()=>[t(f,null,{default:n(()=>[t(v,null,{default:n(()=>[k("Action")]),_:1}),_("div",he,[t(w,{color:"primary",icon:"visibility",label:"View",size:"sm",onClick:e[1]||(e[1]=a=>o.handleView())}),t(w,{color:"secondary",icon:"edit",label:"Edit",size:"sm",onClick:e[2]||(e[2]=a=>o.handleEdit())}),t(w,{color:"red",icon:"delete",label:"Delete",size:"sm",onClick:e[3]||(e[3]=a=>o.handleDelete())})])]),_:1})]),_:1})]),_:1})]),_:1},8,["class"])],4)}const ge=Q(ue,[["render",fe]]),ye={props:{data:Object},setup(r){var l;const e=$(),o=V().fetchSessionToken(),d=((l=r.data.row)==null?void 0:l.id)||null;return{handleEdit:()=>{e.handleEditProperty(d,r)},handleDelete:async()=>{await e.handleDeleteProperty(d,o)},handleView:()=>{e.handleViewProperty(d,r)}}}},be=_("div",{class:"row items-center no-wrap font-bold"},"Edit",-1);function _e(r,e,i,o,d,c){return m(),b("div",null,[t(se,{color:"transparent",class:"text-black font-bold","dropdown-icon":"expand_more"},{label:n(()=>[be]),default:n(()=>[t(I,{class:"q-table-edit-dropdown-list"},{default:n(()=>[t(P,{clickable:"",onClick:e[0]||(e[0]=a=>o.handleView())},{default:n(()=>[t(f,null,{default:n(()=>[t(S,{name:"visibility"})]),_:1}),t(f,null,{default:n(()=>[t(v,null,{default:n(()=>[k("View")]),_:1})]),_:1})]),_:1}),t(P,{clickable:"",onClick:e[1]||(e[1]=a=>o.handleEdit())},{default:n(()=>[t(f,null,{default:n(()=>[t(S,{name:"edit"})]),_:1}),t(f,null,{default:n(()=>[t(v,null,{default:n(()=>[k("Edit")]),_:1})]),_:1})]),_:1}),t(P,{clickable:"",onClick:e[2]||(e[2]=a=>o.handleDelete())},{default:n(()=>[t(f,null,{default:n(()=>[t(S,{name:"delete"})]),_:1}),t(f,null,{default:n(()=>[t(v,null,{default:n(()=>[k("Delete")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}const ve=Q(ye,[["render",_e]]),we={components:{TableStatus:ve,TableMobileResponsive:ge},setup(){const r=u(),e=u([]),i=u([]),o=u(!1),d=u({sortBy:"name",descending:!1,page:1,rowsPerPage:15,rowsNumber:null}),c=u([]),a=u({}),g=u(""),l=$(),y=le(),T=ce(),z=V().fetchSessionToken(),D=u([]),E=u(!1),N=s=>{s.highlight=s.checked,E.value=!0,D.value.some(p=>s.id===p.id?(p.highlight=s.checked,!0):!1)||D.value.push({...s,highlight:s.checked})},U=async s=>{const h=await l.submitHighlight(s,z);console.log(h)},H=s=>T.fetchPaginationData(s,a.value),Y=s=>{a.value={...a.value,keyword:s,searchable:["name","short_description","price","listing_type"],page:1,attribute:"name",sortable:"asc",paginate:15},M(null,a.value)},M=async(s,h)=>{const p=await T.fetchTableListData(s,o,l,"fetchPropertyList",h),F=p.data.map(A=>({...A,created_by:A.user.name,created_at:de(A.created_at).format("YYYY-MM-DD HH:mm:ss")}));return e.value=F,s!=null&&(d.value=T.fetchServerPagination(p,s)),h=T.fetchServerPayload(h,p),o.value=!1,p},j=async s=>{const h=H(s.pagination),p=y.fetchPropertyColumns();return i.value=p,M(s.pagination,h)};return oe(()=>{r.value.requestServerInteraction()}),{propertyRef:r,loading:o,pagination:d,columns:i,rows:e,onRequest:j,selected:c,fetchPagination:H,handlePostKeywords:Y,searchKeyword:g,handleHighlight:N,submitHighlight:U,isHighlighted:E,propertyData:D,getSelectedString(){return c.value.length===0?"":`${c.value.length} record${c.value.length>1?"s":""} selected of ${e.value.length}`}}}},Se={class:"q-py-md"},ke=["for"],Pe=["innerHTML"];function Te(r,e,i,o,d,c){const a=q("TableStatus"),g=q("TableMobileResponsive");return m(),b("div",Se,[t(Z,{flat:"",ref:"propertyRef",bordered:"",grid:r.$q.screen.lt.md,rows:o.rows,columns:o.columns,pagination:o.pagination,"onUpdate:pagination":e[5]||(e[5]=l=>o.pagination=l),selected:o.selected,"onUpdate:selected":e[6]||(e[6]=l=>o.selected=l),loading:o.loading,"binary-state-sort":"",onRequest:o.onRequest,"selected-rows-label":o.getSelectedString,selection:"multiple","row-key":"name",class:"property-table","wrap-cells":""},{"top-right":n(()=>[o.isHighlighted?(m(),x(w,{key:0,color:"primary",icon:"star",class:"mr-4",onClick:e[0]||(e[0]=l=>o.submitHighlight(o.propertyData))})):K("",!0),t(O,{borderless:"",dense:"",debounce:"300",modelValue:o.searchKeyword,"onUpdate:modelValue":e[3]||(e[3]=l=>o.searchKeyword=l),placeholder:"Search",class:"border px-4 rounded-lg",onKeyup:e[4]||(e[4]=ne(l=>o.handlePostKeywords(o.searchKeyword),["enter"]))},{append:n(()=>[o.searchKeyword!==""?(m(),x(S,{key:0,name:"close",onClick:e[1]||(e[1]=l=>o.searchKeyword=""),class:"cursor-pointer"})):K("",!0),t(S,{name:"search",onClick:e[2]||(e[2]=l=>o.handlePostKeywords(o.searchKeyword)),class:"cursor-pointer"})]),_:1},8,["modelValue"])]),"header-cell":n(l=>[t(W,{props:l,style:{"text-wrap":"nowrap"}},{default:n(()=>[_("label",{for:l.col.label,class:"font-bold text-sm"},L(l.col.label),9,ke)]),_:2},1032,["props"])]),"body-cell-short_description":n(l=>[t(C,{props:l},{default:n(()=>[_("div",{class:"break-all",innerHTML:l.value},null,8,Pe)]),_:2},1032,["props"])]),"body-cell-highlight":n(l=>[t(C,{props:l},{default:n(()=>[t(B,{size:"sm",modelValue:l.row.checked,"onUpdate:modelValue":y=>l.row.checked=y,val:"sm",onClick:y=>o.handleHighlight(l.row)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:2},1032,["props"])]),"body-cell-action":n(l=>[t(C,{props:l},{default:n(()=>[t(a,{data:l},null,8,["data"])]),_:2},1032,["props"])]),item:n(l=>[t(g,{props:l},null,8,["props"])]),_:1},8,["grid","rows","columns","pagination","selected","loading","onRequest","selected-rows-label"])])}const Qe=Q(we,[["render",Te]]),Ve={components:{TableList:Qe}},De={class:"row q-gutter-y-sm justify-between"},Ae=_("div",{class:"col col-auto text-2xl"},"Property List",-1),Ce={class:"col col-auto text-right"};function xe(r,e,i,o,d,c){const a=q("TableList");return m(),b(R,null,[_("div",De,[Ae,_("div",Ce,[t(w,{"icon-right":"add",label:"Add Property",class:"!font-bold text-white",color:"primary",to:{name:"property.form",query:{type:"create"}}},null,8,["to"])])]),t(a)],64)}const tt=Q(Ve,[["render",xe]]);export{tt as default};
