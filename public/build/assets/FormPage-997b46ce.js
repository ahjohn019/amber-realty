import{l as H,J as I,d as De,u as be,ao as pe,a as ae,B as ue,r as u,n as C,x as k,G as a,s as _,R as se,F as le,D as xe,A as t,X as ne,H as h,ap as Ve,m as O,W as x,q as Se,N as re}from"./ckeditor-6cef9db6.js";import{c as J,Q as Ce,n as Pe,o as we,h as Ie,e as w}from"./focus-manager-07b39634.js";import{u as ke,a as Fe,b as Te}from"./use-checkbox-846dd339.js";import{Q as V}from"./QInput-ecc5a956.js";import{b as Ue,Q as S}from"./QSelect-e6d2a572.js";import{C as qe,D as Qe,u as Ae}from"./refList-68ac9381.js";import{a as Me,u as Be}from"./index-9d0de8f5.js";import{S as G,u as me}from"./app-617864c5.js";import{a as ie,Q as g}from"./QCard-8c8f8c6a.js";import{Q as Ee}from"./QImg-77ae440c.js";import{Q as de}from"./QChip-6e88bffb.js";import{Q as Le}from"./QSeparator-22cad650.js";import{C as Re}from"./ClosePopup-a22a9596.js";import"./option-sizes-8193bdc4.js";import"./QMenu-93765cf2.js";import"./use-prevent-scroll-774b52f2.js";const je=J({name:"QToggle",props:{...ke,icon:String,iconColor:String},emits:Fe,setup(n){function o(r,e){const i=H(()=>(r.value===!0?n.checkedIcon:e.value===!0?n.indeterminateIcon:n.uncheckedIcon)||n.icon),m=H(()=>r.value===!0?n.iconColor:null);return()=>[I("div",{class:"q-toggle__track"}),I("div",{class:"q-toggle__thumb absolute flex flex-center no-wrap"},i.value!==void 0?[I(Ce,{name:i.value,color:m.value})]:void 0)]}return Te("toggle",o)}}),Ne=I("div",{class:"q-space"}),ze=J({name:"QSpace",setup(){return()=>Ne}}),Oe=J({name:"QCardActions",props:{...Pe,vertical:Boolean},setup(n,{slots:o}){const r=we(n),e=H(()=>`q-card__actions ${r.value} q-card__actions--${n.vertical===!0?"vert column":"horiz row"}`);return()=>I("div",{class:e.value},Ie(o.default))}}),ce="/api/server-files/",Ge=De("server_image_admin",{state:()=>({post_image_admin:null,router:be(),route:pe()}),actions:{async updateFiles(n,o){const r={headers:{Authorization:`Bearer ${o}`,"Content-Type":"multipart/form-data"}};try{const e=await ae.post(ce+"update",n,r);return G.fire({text:"Image Update Successfully",icon:"success"}).then(i=>{i.isConfirmed&&this.router.go(0)}),e.data}catch(e){return G.fire({title:e.response.data.data,text:e.response.data.message,icon:"error"}),e.response}},async deleteFiles(n,o){const r={headers:{Authorization:`Bearer ${o}`,"Content-Type":"multipart/form-data"}};try{const e=await ae.post(ce+"delete",n,r);return G.fire({text:"Image Deleted Successfully",icon:"success"}).then(i=>{i.isConfirmed&&this.router.go(0)}),e.data}catch(e){throw console.error("Error:",e),e}},handleMultipleImageChange(n,o){const r=o.target.id,e=o.target.files[0],i=n.value.find(m=>m.id===r)||{id:r};return i.file=e,n.value.includes(i)||n.value.push(i),n}}});const He={props:["property"],setup(n){var q;const o=me(),r=Ge(),e=o.fetchSessionToken(),i=u(!1),m=[{label:"Banner Image",value:"banner-image"},{label:"Slider Image",value:"slider-image"}],s=((q=n.property)==null?void 0:q.file)||[],f=u([]),c=u([]),l=async()=>{c.value=s.map(d=>({module_path:d.module_path,file_id:d.id}))},F=d=>{const v=d.target.getAttribute("data-file-index");c.value[v].module_path=d.target.value},D=async d=>{const v=await r.deleteFiles(d,e);return i.value=!1,v},T=d=>r.handleMultipleImageChange(f,d),U=async()=>{const d={file:f.value,module_path:c.value},v=d.module_path.map(E=>{var P;const b=(P=d.file)==null?void 0:P.find(Q=>parseInt(Q.id)===E.file_id);return{...E,...b}}),B=await r.updateFiles(v,e);return i.value=!1,B};return l(),{existImageModal:i,files:s,updateFileData:U,onFileChange:T,handleDeleteFile:D,modulePathOptions:m,changeModulePath:F,fetchAllModulePath:l}}},Je=t("div",{class:"text-h5"},"Edit",-1),We={class:"col row"},Xe={class:"col"},Ke={class:"text-subtitle1 break-words"},Ye={class:"text-subtitle2"},Ze=["onUpdate:modelValue","data-file-index"],$e=t("option",{value:"banner-image"}," Banner Image ",-1),et=t("option",{value:"slider-image"}," Slider Image ",-1),tt=[$e,et],ot=["id"];function at(n,o,r,e,i,m){return C(),k(le,null,[a(w,{label:"Edit",color:"primary",onClick:o[0]||(o[0]=s=>e.existImageModal=!0),class:"edit-image-form__button"}),a(Ue,{modelValue:e.existImageModal,"onUpdate:modelValue":o[3]||(o[3]=s=>e.existImageModal=s)},{default:_(()=>[a(ie,null,{default:_(()=>[a(g,{class:"row items-center"},{default:_(()=>[Je,a(ze),se(a(w,{icon:"close",flat:"",round:"",dense:""},null,512),[[Re]])]),_:1}),a(g,{class:"q-pt-none q-gutter-y-lg"},{default:_(()=>[(C(!0),k(le,null,xe(e.files,(s,f)=>(C(),k("div",{class:"row items-center",key:f},[t("div",We,[t("div",Xe,[a(ie,{class:"my-card"},{default:_(()=>[a(Ee,{src:s.url,ratio:16/9,fit:"cover"},null,8,["src"]),a(g,null,{default:_(()=>[t("div",Ke,[a(de,{color:"primary","text-color":"white"},{default:_(()=>[ne(h(s.name),1)]),_:2},1024)]),t("div",Ye,[a(de,{color:"teal","text-color":"white",icon:"bookmark"},{default:_(()=>[ne(h(Math.round(s.size/1e3)+"kb"),1)]),_:2},1024)])]),_:2},1024),a(g,{class:"row place-items-center justify-center"},{default:_(()=>[a(g,{class:"col-4 text-center"},{default:_(()=>[a(w,{size:"14px",round:"",color:"red",icon:"delete",onClick:c=>e.handleDeleteFile(s)},null,8,["onClick"])]),_:2},1024),a(Le,{vertical:""}),a(g,{class:"col-4"},{default:_(()=>[se(t("select",{"onUpdate:modelValue":c=>s.module_path=c,"data-file-index":f,onChange:o[1]||(o[1]=(...c)=>e.changeModulePath&&e.changeModulePath(...c))},tt,40,Ze),[[Ve,s.module_path]])]),_:2},1024)]),_:2},1024),a(g,{class:"q-pt-none row justify-center"},{default:_(()=>[a(g,{class:"col-7"},{default:_(()=>[t("input",{type:"file",multiple:"",name:"file",id:s.id,class:"hidden-input",onChange:o[2]||(o[2]=(...c)=>e.onFileChange&&e.onFileChange(...c)),ref_for:!0,ref:"currentFile",accept:".pdf,.jpg,.jpeg,.png"},null,40,ot)]),_:2},1024)]),_:2},1024)]),_:2},1024)])])]))),128))]),_:1}),a(Oe,{align:"right"},{default:_(()=>[a(w,{label:"Update",class:"text-white bg-primary update-form__button",onClick:e.updateFileData},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const st=ue(He,[["render",at]]);const lt={components:{CkeditorPlugin:qe,DropFile:Qe,ExistImageModal:st},async setup(){var Y,Z;const n=pe(),o=((Y=n.query)==null?void 0:Y.type)||null,r=((Z=n.query)==null?void 0:Z.id)||null,e=Me(),i=Ae(),m=Be(),s=u(e.fetchPropertyData()),f=u(e.fetchPropertyDetailsData()),c=u(e.fetchPropertyError()),l=u([]),F=u(0),D=u(!1),T=u([]),U=u([]),q=u(null),d=u(""),v=u(""),B=u(!1);s.value.status="Active";const b=me().fetchSessionToken(),P=e.fetchTenureData(),Q=e.fetchFurnishingData(),W=e.fetchListingTypeData(),_e=e.fetchStatusData(),X=async()=>{const p=await i.fetchStateList(b);T.value=p},L=async()=>{const p=await i.fetchPropertyTypes(b);return U.value=p,p},fe=()=>(F.value=D.value?1:0,F.value),ye=p=>{s.value={...s.value,images:p.files,module_path:p.module_path}},he=p=>{d.value=URL.createObjectURL(p.target.files[0]),v.value=p.target.files[0]},ve=p=>{s.value.description=p},K=async()=>{const p=await L(),R=await m.findProperty(b,r),j=R.file.filter(z=>z.module_path==="banner-image");j.length>0&&(d.value=j[0].url);const{name:$,description:ee,short_description:te,state:N,price:oe,file:A,type:M,details:y}=R;s.value={...s.value,name:$,description:ee,short_description:te,state:N,price:oe,file:A,property_types:m.filteredPropertyDetails({type:p,details:M,category:"propertyType"})},y&&(D.value=!0,f.value={...f.value,tenure:m.filteredPropertyDetails({type:P,details:y.tenure}),square_feet:y.square_feet,listing_type:m.filteredPropertyDetails({type:W,details:y.listing_type}),furnishing:m.filteredPropertyDetails({type:Q,details:y.furnishing}),bedroom:y.bedroom,bathroom:y.bathroom})},ge=async()=>{var A,M;s.value={...s.value,property_details:D.value?1:0,status:{slug:((A=s.value.status)==null?void 0:A.slug)||"active",label:((M=s.value.status)==null?void 0:M.label)||"Active"},banner_url:v.value};const{tenure:p,bathroom:R,bedroom:j,square_feet:$,listing_type:ee,furnishing:te,...N}=s.value;return s.value=N,s.value.property_details>0&&(s.value={...s.value,...Object.fromEntries(Object.entries(f.value).map(([y,z])=>[y,z??null]))}),await m.createProperty(b,s.value,c)};return o==="update"&&await K(),await X(),await L(),{findProperty:K,propertyData:s,propertyDetailsData:f,submitData:ge,updateParentFiles:ye,updateDescriptions:ve,propertyDetailsToggle:D,handlePropertyDetails:fe,options:l,errors:c,tenure:P,furnishing:Q,listingType:W,status:_e,state:T,property_types:U,stateList:X,propertyTypesList:L,mainImage:q,bannerUrl:d,updateMainImage:he,routeType:o,existImageModal:B}}},nt={class:"row"},rt={class:"col-12 row pb-4"},it=t("div",{class:"col text-2xl"},"Property Form",-1),dt={class:"col text-right"},ct=t("span",{class:"font-bold"},"Details",-1),pt={class:"col-12 row bg-white p-5 font-bold gap-y-4"},ut={class:"col-12 post-information-name pb-2"},mt={class:"col-12"},_t=t("div",{class:"post-information-name"},"Name",-1),ft={class:"col-12"},yt={class:"col-12 text-red-700 pt-2"},ht={class:"col-12"},vt=t("div",{class:"post-information-name"},"Descriptions",-1),gt={class:"col-12"},Dt={class:"col-12 text-red-700 pt-2"},bt={class:"col-12"},xt=t("div",{class:"post-information-name"},"Short Descriptions",-1),Vt={class:"col-12"},St={class:"col-12 text-red-700 pt-2"},Ct=t("div",{class:"post-information-name"},"Status",-1),Pt={class:"col-12 col-md-6"},wt=t("div",{class:"post-information-name"},"Types",-1),It={class:"col-12 text-red-700 pt-2"},kt=t("div",{class:"post-information-name"},"State",-1),Ft={class:"col-12 text-red-700 pt-2"},Tt={class:"col-12 col-md-6"},Ut=t("div",{class:"post-information-name"},"Price",-1),qt=t("div",{class:"post-information-name"},"Tenure",-1),Qt={class:"col-12 col-md-6"},At=t("div",{class:"post-information-name"},"Square Feet",-1),Mt=t("div",{class:"post-information-name"},"Listing Type",-1),Bt={class:"col-12 col-md-6"},Et=t("div",{class:"post-information-name"},"Furnished Type",-1),Lt=t("div",{class:"post-information-name"},"Bathroom",-1),Rt={class:"col-12 col-md-6"},jt=t("div",{class:"post-information-name"},"Bedroom",-1),Nt={class:"col-12"},zt={class:"flex justify-between py-2"},Ot=t("div",{class:"post-information__name"},"Images",-1),Gt={key:0},Ht={class:"col-12 text-red-700 pt-2"},Jt={class:"col-12 text-right"};function Wt(n,o,r,e,i,m){const s=O("CkeditorPlugin"),f=O("ExistImageModal"),c=O("DropFile");return C(),k("div",nt,[t("div",rt,[it,t("div",dt,[ct,a(je,{modelValue:e.propertyDetailsToggle,"onUpdate:modelValue":o[0]||(o[0]=l=>e.propertyDetailsToggle=l),color:"green",onClick:e.handlePropertyDetails},null,8,["modelValue","onClick"])])]),t("div",pt,[t("div",ut,h(e.routeType=="update"?"Update":"Create")+" Property ",1),t("div",mt,[_t,t("div",ft,[a(V,{dense:"",outlined:"",label:"Name",modelValue:e.propertyData.name,"onUpdate:modelValue":o[1]||(o[1]=l=>e.propertyData.name=l),ref:"nameRef"},null,8,["modelValue"])]),t("div",yt,h(e.errors.name),1)]),t("div",ht,[vt,t("div",gt,[a(s,{description:e.propertyData.description,onUpdateDescriptionsData:e.updateDescriptions},null,8,["description","onUpdateDescriptionsData"])]),t("div",Dt,h(e.errors.description),1)]),t("div",bt,[xt,t("div",Vt,[a(V,{modelValue:e.propertyData.short_description,"onUpdate:modelValue":o[2]||(o[2]=l=>e.propertyData.short_description=l),filled:"",outlined:"",placeholder:"Short Descriptions",type:"textarea"},null,8,["modelValue"])]),t("div",St,h(e.errors.short_description),1)]),t("div",{class:x(["col-12 col-md-6",n.$q.screen.lt.md?"pr-0":"pr-6"])},[Ct,a(S,{dense:"",modelValue:e.propertyData.status,"onUpdate:modelValue":o[3]||(o[3]=l=>e.propertyData.status=l),options:e.status,"option-value":"slug","option-label":"label",label:"Status"},null,8,["modelValue","options"])],2),t("div",Pt,[wt,a(S,{dense:"",modelValue:e.propertyData.property_types,"onUpdate:modelValue":o[4]||(o[4]=l=>e.propertyData.property_types=l),options:e.property_types,"option-value":"id","option-label":"label",label:"Please Select"},null,8,["modelValue","options"]),t("div",It,h(e.errors.type_id),1)]),t("div",{class:x(["col-12 col-md-6",n.$q.screen.lt.md?"pr-0":"pr-6"])},[kt,a(S,{dense:"",modelValue:e.propertyData.state,"onUpdate:modelValue":o[5]||(o[5]=l=>e.propertyData.state=l),options:e.state,"option-value":"id","option-label":"label",label:"Please Select"},null,8,["modelValue","options"]),t("div",Ft,h(e.errors.state_id),1)],2),t("div",Tt,[Ut,a(V,{dense:"",outlined:"",label:"Price",modelValue:e.propertyData.price,"onUpdate:modelValue":o[6]||(o[6]=l=>e.propertyData.price=l),type:"number"},null,8,["modelValue"])]),t("div",{class:x(["col-12 row gap-y-4",e.propertyDetailsToggle?"":"hidden"])},[t("div",{class:x(["col-12 col-md-6",n.$q.screen.lt.md?"pr-0":"pr-6"])},[qt,a(S,{dense:"",modelValue:e.propertyDetailsData.tenure,"onUpdate:modelValue":o[7]||(o[7]=l=>e.propertyDetailsData.tenure=l),options:e.tenure,"option-value":"slug","option-label":"label",label:"Please Select"},null,8,["modelValue","options"])],2),t("div",Qt,[At,a(V,{dense:"",outlined:"",label:"Square Feet",modelValue:e.propertyDetailsData.square_feet,"onUpdate:modelValue":o[8]||(o[8]=l=>e.propertyDetailsData.square_feet=l),type:"number"},null,8,["modelValue"])]),t("div",{class:x(["col-12 col-md-6",n.$q.screen.lt.md?"pr-0":"pr-6"])},[Mt,a(S,{dense:"",modelValue:e.propertyDetailsData.listing_type,"onUpdate:modelValue":o[9]||(o[9]=l=>e.propertyDetailsData.listing_type=l),options:e.listingType,"option-value":"slug","option-label":"label",label:"Please Select"},null,8,["modelValue","options"])],2),t("div",Bt,[Et,a(S,{dense:"",modelValue:e.propertyDetailsData.furnishing,"onUpdate:modelValue":o[10]||(o[10]=l=>e.propertyDetailsData.furnishing=l),options:e.furnishing,"option-value":"slug","option-label":"label",label:"Please Select"},null,8,["modelValue","options"])]),t("div",{class:x(["col-12 col-md-6",n.$q.screen.lt.md?"pr-0":"pr-6"])},[Lt,a(V,{dense:"",outlined:"",label:"Bathroom",modelValue:e.propertyDetailsData.bathroom,"onUpdate:modelValue":o[11]||(o[11]=l=>e.propertyDetailsData.bathroom=l),type:"number"},null,8,["modelValue"])],2),t("div",Rt,[jt,a(V,{dense:"",outlined:"",label:"Bedroom",modelValue:e.propertyDetailsData.bedroom,"onUpdate:modelValue":o[12]||(o[12]=l=>e.propertyDetailsData.bedroom=l),type:"number"},null,8,["modelValue"])])],2),t("div",Nt,[t("div",zt,[Ot,e.routeType==="update"?(C(),k("div",Gt,[e.propertyData.file.length>0?(C(),Se(f,{key:0,property:e.propertyData},null,8,["property"])):re("",!0)])):re("",!0)]),a(c,{onUpdateFiles:e.updateParentFiles,propertyData:e.propertyData},null,8,["onUpdateFiles","propertyData"]),t("div",Ht,h(e.errors.module_path),1)]),t("div",Jt,[a(w,{label:e.routeType=="update"?"Update":"Submit",class:"text-white bg-primary update-form__button",onClick:e.submitData},null,8,["label","onClick"])])])])}const uo=ue(lt,[["render",Wt]]);export{uo as default};
