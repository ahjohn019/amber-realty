import{Q as v,e as C}from"./QBtn-6cd060e5.js";import{Q as E,a as I,b as M,d as V}from"./dayjs.min-cea278b7.js";import{d as Y,u as Q,B as T,n as x,x as $,A as m,G as o,s as a,X as S,r as p,o as H,m as A,H as D,F as j}from"./ckeditor-6f66a585.js";import{u as q,a as F}from"./index-02771ade.js";import{u as B}from"./app-3c9b8a54.js";import{Q as w,d as _,c as P}from"./QMenu-e3208ca6.js";import{a as O,b as U}from"./QBtnDropdown-f4429c8a.js";import"./QSelect-1111016d.js";import"./use-key-composition-ebd764dc.js";import"./use-prevent-scroll-8be0ed78.js";import"./QLinearProgress-a5cbf896.js";import"./QCheckbox-0db9a1ae.js";import"./use-checkbox-def453ee.js";import"./option-sizes-27b80303.js";const G=Y("server_table_admin",{state:()=>({post_table_admin:null,router:Q()}),actions:{fetchPaginationData(n,e){const{page:c,rowsPerPage:t,sortBy:d,descending:r}=n;return e={...e,attribute:d,sortable:r?"desc":"asc",page:c,paginate:t},e.paginate<=0&&(e.paginate=n.rowsNumber),e},fetchServerPagination(n,e){return{rowsNumber:n.meta.total,page:e.page,rowsPerPage:e.rowsPerPage,sortBy:e.sortBy,descending:e.descending}},fetchServerPayload(n,e){return{...n,rowsPerPage:e.meta.per_page}},async fetchTableListData(n,e,c,t,d){const l=B().fetchSessionToken(),{page:s}=n??{page:1,rowsPerPage:15,sortBy:null,descending:null};return e.value=!0,await c[t](l,s,d)}}}),J={props:{data:Object},setup(n){var g,u;const e=Q(),c=q(),d=B().fetchSessionToken(),r=((u=(g=n.data)==null?void 0:g.row)==null?void 0:u.id)||null;return{handleEdit:()=>{e.push({name:"property.form",query:{type:"update",id:r}})},handleDelete:async()=>await c.deleteProperty(d,r)}}},K={class:"flex"},X=m("div",{class:"row items-center no-wrap font-bold"},"Edit",-1);function z(n,e,c,t,d,r){return x(),$("div",K,[m("div",null,[o(U,{color:"transparent",class:"text-black font-bold","dropdown-icon":"expand_more"},{label:a(()=>[X]),default:a(()=>[o(O,{class:"q-table-edit-dropdown-list"},{default:a(()=>[o(w,{clickable:""},{default:a(()=>[o(_,null,{default:a(()=>[o(v,{name:"visibility"})]),_:1}),o(_,null,{default:a(()=>[o(P,null,{default:a(()=>[S("View")]),_:1})]),_:1})]),_:1}),o(w,{clickable:"",onClick:e[0]||(e[0]=l=>t.handleEdit())},{default:a(()=>[o(_,null,{default:a(()=>[o(v,{name:"edit"})]),_:1}),o(_,null,{default:a(()=>[o(P,null,{default:a(()=>[S("Edit")]),_:1})]),_:1})]),_:1}),o(w,{clickable:"",onClick:e[1]||(e[1]=l=>t.handleDelete())},{default:a(()=>[o(_,null,{default:a(()=>[o(v,{name:"delete"})]),_:1}),o(_,null,{default:a(()=>[o(P,null,{default:a(()=>[S("Delete")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])])}const W=T(J,[["render",z]]),Z={components:{TableStatus:W},setup(){const n=p(),e=p([]),c=p([]),t=p(!1),d=p({sortBy:"name",descending:!1,page:1,rowsPerPage:15,rowsNumber:null}),r=p([]),l=p({}),s=q(),g=F(),u=G(),h=i=>u.fetchPaginationData(i,l.value),L=i=>{l.value={...l.value,keyword:i,searchable:[],page:1,attribute:"name",sortable:"asc",paginate:15},k(null,l.value)},k=async(i,b)=>{const f=await u.fetchTableListData(i,t,s,"fetchPropertyList",b),R=f.data.map(y=>({...y,created_by:y.user.name,created_at:V(y.created_at).format("YYYY-MM-DD HH:mm:ss")}));return e.value=R,d.value=u.fetchServerPagination(f,i),b=u.fetchServerPayload(b,f),t.value=!1,f},N=async i=>{const b=h(i.pagination),f=g.fetchPropertyColumns();return c.value=f,k(i.pagination,b)};return H(()=>{n.value.requestServerInteraction()}),{propertyRef:n,loading:t,pagination:d,columns:c,rows:e,onRequest:N,selected:r,fetchPagination:h,handlePostKeywords:L,getSelectedString(){return console.log(r.value),r.value.length===0?"":`${r.value.length} record${r.value.length>1?"s":""} selected of ${e.value.length}`}}}},ee={class:"q-py-md"},te=["for"],oe={class:"q-mt-md"};function ae(n,e,c,t,d,r){const l=A("TableStatus");return x(),$("div",ee,[o(M,{flat:"",ref:"propertyRef",bordered:"",grid:n.$q.screen.lt.sm,rows:t.rows,columns:t.columns,pagination:t.pagination,"onUpdate:pagination":e[0]||(e[0]=s=>t.pagination=s),selected:t.selected,"onUpdate:selected":e[1]||(e[1]=s=>t.selected=s),loading:t.loading,"binary-state-sort":"",onRequest:t.onRequest,"selected-rows-label":t.getSelectedString,selection:"multiple","row-key":"name",class:"property-table"},{"header-cell":a(s=>[o(E,{props:s},{default:a(()=>[m("label",{for:s.col.label,class:"font-bold text-sm"},D(s.col.label),9,te)]),_:2},1032,["props"])]),"body-cell-status":a(s=>[o(I,{props:s},{default:a(()=>[o(l,{data:s},null,8,["data"])]),_:2},1032,["props"])]),_:1},8,["grid","rows","columns","pagination","selected","loading","onRequest","selected-rows-label"]),m("div",oe,"Selected: "+D(JSON.stringify(t.selected)),1)])}const ne=T(Z,[["render",ae]]),se={components:{TableList:ne}},re={class:"row"},le=m("div",{class:"col text-2xl"},"Property List",-1),ce={class:"col text-right"};function de(n,e,c,t,d,r){const l=A("TableList");return x(),$(j,null,[m("div",re,[le,m("div",ce,[o(C,{"icon-right":"add",label:"Add Property",class:"!font-bold text-white",color:"primary",to:{name:"property.form",query:{type:"create"}}},null,8,["to"])])]),o(l)],64)}const Te=T(se,[["render",de]]);export{Te as default};
